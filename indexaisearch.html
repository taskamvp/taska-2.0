<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taska | Explore Elite Talent</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/overview.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; }
        body { 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #f8f9fa 100%);
            min-height: 100vh; 
            color: #1a1a1a; 
            padding-bottom: 60px; 
        }
        
        
        
        .dashboard-content { 
            padding: 2rem 1rem; 
            max-width: 1400px; 
            margin: 0 auto; 
        }
        
        .dashboard-section h1 {
            font-size: clamp(2.2rem, 7vw, 3rem);
            color: #14532d;
            margin-bottom: 0.5rem;
            font-weight: 700;
            margin-top: 1.2rem;
            letter-spacing: -0.02em;
            line-height: 1.4;
        }
        
        .dashboard-section p { 
            font-size: clamp(1rem, 3.5vw, 1.2rem); 
            margin-bottom: 1.5rem; 
            color: #374151; 
            font-weight: 500;
            line-height: 1.6;
            letter-spacing: 0.01em;
        }
        
        .search-container {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(24px) saturate(1.2);
            -webkit-backdrop-filter: blur(24px) saturate(1.2);
            border-radius: 1rem;
            border: 2px solid rgba(20, 85, 20, 0.13);
            padding: 1.5rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px 0 rgba(20, 85, 20, 0.10);
        }
        
        .search-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(43, 108, 176, 0.05) 0%, transparent 70%);
            pointer-events: none;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: #ffffff;
            padding: 0.5rem;
            border-radius: 12px;
            border: 1.5px solid #e5e7ea;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            width: calc(100% - 50px);
            max-width: 1500px;
            min-width: 220px;
            margin: 0 auto;
            box-shadow: 0 4px 32px 0 rgba(20, 85, 20, 0.10);
        }
        
        .search-box:hover,
        .search-box:focus-within {
            border-color: #14532d;
            box-shadow: 0 8px 32px 0 rgba(20, 85, 20, 0.15);
        }
        
        .search-icon {
            color: #14532d;
            font-size: 1.2rem;
            margin-left: 1rem;
        }
        
        .search-input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 0.75rem 0.5rem;
            font-size: 1rem;
            color: #1a1a1a;
            outline: none;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
        }
        
        .search-input::placeholder {
            color: #6b7280;
            font-style: normal;
        }
        
        .search-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #14532d, #166534);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 12px rgba(20, 83, 45, 0.3);
        }
        
        .search-btn:hover {
            background: linear-gradient(135deg, #166534, #14532d);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(20, 83, 45, 0.4);
        }
        
        .btn-text {
            font-size: 0.95rem;
        }
        
        .btn-icon {
            font-size: 0.9rem;
        }
        
        .search-info {
            margin-top: 1.5rem;
            padding: 1.5rem 0;
            background: none;
            border: none;
            box-shadow: none;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .search-info .help-cards-row {
            display: flex;
            gap: 2.2rem;
            flex-wrap: wrap;
            justify-content: center;
            align-items: stretch;
        }
        
        .search-info .help-card {
            background: rgba(255,255,255,0.82);
            backdrop-filter: blur(10px) saturate(1.1);
            -webkit-backdrop-filter: blur(10px) saturate(1.1);
            border-radius: 12px;
            border: 1.5px solid #e3e8f0;
            box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.1);
            padding: 2.1rem 1.6rem 1.5rem 1.6rem;
            flex: 1 1 260px;
            min-width: 240px;
            max-width: 340px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 1.1rem;
            margin-bottom: 1.2rem;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .search-info .help-card:hover {
            background: rgba(255,255,255,0.97);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.15);
            border: 1.5px solid #14532d;
            transform: translateY(-4px);
        }
        
        .search-info .help-card .help-icon {
            display: none;
        }
        
        .search-info .help-card .help-title {
            font-size: 1.18rem;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 0.2rem;
        }
        
        .search-info .help-card .help-desc {
            font-size: 1.01rem;
            color: #444;
            line-height: 1.6;
            font-weight: 500;
        }
        
        @media (max-width: 900px) {
            .search-info .help-cards-row {
                gap: 1.2rem;
            }
            .search-info .help-card {
                min-width: 180px;
                max-width: 100%;
                padding: 1.3rem 1rem 1.1rem 1rem;
            }
        }
        
        .loading-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(248, 249, 250, 0.95); 
            backdrop-filter: blur(8px);
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 1001; 
        }
        
        .loader { 
            width: 200px; 
            height: 6px; 
            background: #e9ecef; 
            position: relative; 
            overflow: hidden; 
            border-radius: 3px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .loader::before { 
            content: ''; 
            position: absolute; 
            left: -50%; 
            height: 100%; 
            width: 50%; 
            background: linear-gradient(90deg, #14532d, #166534, #14532d);
            animation: lineLoading 2s infinite ease-in-out;
            border-radius: 3px;
        }
        
        @keyframes lineLoading { 
            0% { left: -50%; } 
            50% { left: 50%; } 
            100% { left: 150%; } 
        }
        
        /* Loading Animation inspired from login.html */
        .fashion-loader {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            text-align: center;
        }
        
        .fashion-loader-icon {
            width: 60px;
            height: 60px;
            position: relative;
        }
        
        .fashion-loader-dots {
            display: flex;
            gap: 6px;
            justify-content: center;
            margin-bottom: 1rem;
        }
        
        .fashion-loader-dot {
            width: 8px;
            height: 8px;
            background: #007bff;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        
        .fashion-loader-dot:nth-child(1) { animation-delay: -0.32s; }
        .fashion-loader-dot:nth-child(2) { animation-delay: -0.16s; }
        .fashion-loader-dot:nth-child(3) { animation-delay: 0s; }
        
        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }
        
        .fashion-loader-text {
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            color: #333;
            text-align: center;
            margin-bottom: 0.5rem;
        }
        
        .fashion-loader-subtitle {
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
            font-size: 0.9rem;
            color: #666;
            text-align: center;
            opacity: 0.8;
        }
        
        .fashion-loader-progress {
            width: 200px;
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }
        
        .fashion-loader-progress-bar {
            height: 100%;
            background: #007bff;
            border-radius: 2px;
            animation: progress 2s ease-in-out infinite;
            position: relative;
        }
        
        @keyframes progress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        .students-list {
            display: flex;
            flex-direction: column;
            gap: 0;
            margin-top: 2rem;
            align-items: center;
        }
        
        .student-card {
            background: #fff;
            border: 1.5px solid #e5e7ea;
            border-radius: 0.7rem;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1200px;
            min-height: auto;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            transition: all 0.18s ease;
            margin-bottom: 1.5rem;
            position: relative;
            padding: 1.5rem;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card:hover {
            background: #fff;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border-color: #facc15;
            transform: translateY(-2px);
        }
        
        .student-card:last-child {
            margin-bottom: 0;
        }
        
        .student-card img.profile-pic {
            width: 60px;
            height: 60px;
            border-radius: 0.7rem;
            object-fit: cover;
            flex-shrink: 0;
            border: 1.5px solid #e5e7ea;
            background: #f8f9fa;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .student-card .card-content {
            display: grid;
            grid-template-columns: 1.2fr 1fr 1.5fr auto;
            align-items: center;
            gap: 1.5rem;
            width: 100%;
            padding: 0;
            min-width: 0;
        }
        
        .student-card .basic-info,
        .student-card .education-info,
        .student-card .skills-info {
            padding: 0;
            min-width: 0;
            max-width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            border-right: 1px solid #e9ecef;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .student-card .basic-info h3,
        .student-card .basic-info h4,
        .student-card .education-info p,
        .student-card .skills-info p {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            display: block;
            max-width: 100%;
            cursor: pointer;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card .actions {
            border-right: none;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: flex-end;
            gap: 1.5rem;
            padding-left: 0.7rem;
            min-width: 120px;
        }
        
        .student-card h3 {
            font-size: 1.1rem;
            color: #111;
            font-weight: 600;
            margin: 0 0 0.3rem 0;
            letter-spacing: -0.01em;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card h4 {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card .year-badge {
            background: #111;
            color: #fff;
            padding: 0.2rem 0.6rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card .contact-info a {
            color: #007bff;
            text-decoration: none;
            font-size: 0.85rem;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card .contact-info a:hover {
            text-decoration: underline;
        }
        
        .student-card p {
            font-size: 0.9rem;
            color: #666;
            margin: 0.2rem 0;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .student-card p strong {
            color: #111;
            font-weight: 600;
        }
        
        .ai-intro-btn {
            background: linear-gradient(135deg, #14532d, #166534);
            color: #ffffff;
            border: none;
            padding: 0.5rem 1rem;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            text-decoration: none;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(20, 83, 45, 0.3);
        }
        
        .ai-intro-btn:hover {
            background: linear-gradient(135deg, #166534, #14532d);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(20, 83, 45, 0.4);
        }
        
        .ai-intro-btn.connected {
            background: #198754;
            color: #ffffff;
            border: none;
            cursor: not-allowed;
            text-decoration: none;
            box-shadow: none;
        }
        
        .ai-intro-btn.connected:hover {
            background: #198754;
            color: #ffffff;
            border: none;
            text-decoration: none;
            transform: none;
            box-shadow: none;
        }
        
        .toggle-details {
            color: #007aff;
            font-size: 0.95rem;
            cursor: pointer;
            text-decoration: underline;
            margin-top: 0;
            display: inline-block;
            background: none;
            border: none;
            padding: 0;
            border-radius: 0;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .toggle-details:hover {
            color: #0056cc;
            text-decoration: underline;
        }
        
        .social-icons {
            display: none;
        }
        
        .student-details {
            display: none;
            width: 100%;
            padding: 1rem 0 0 0;
            border-top: 1px solid #e5e7ea;
            margin-top: 1rem;
        }
        
        .student-details.expanded {
            display: block;
        }
        
        .detail-section {
            margin-bottom: 0.75rem;
        }
        
        .detail-section h5 {
            font-size: 0.75rem;
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.25rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .detail-section p {
            font-size: 0.75rem;
            color: #6c757d;
            margin-bottom: 0.15rem;
            line-height: 1.3;
        }
        
        .detail-section p strong {
            color: #495057;
            font-weight: 500;
        }
        
        .detail-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .detail-section li {
            font-size: 0.75rem;
            color: #6c757d;
            margin-bottom: 0.15rem;
            padding-left: 0;
        }
        
        .detail-section a {
            color: #007aff;
            text-decoration: none;
        }
        
        .detail-section a:hover {
            text-decoration: underline;
        }
        
        .pagination { display: none; }
        
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); z-index: 999; }
        .overlay.active { display: block; }
        
        footer { 
            background: linear-gradient(135deg, #14532d, #166534); 
            color: #ffffff;
            padding: 1rem; 
            text-align: center; 
            position: fixed;
            bottom: 0; 
            width: 100%; 
            box-shadow: 0 -4px 20px rgba(20, 83, 45, 0.3); 
        }
        
        @media (max-width: 900px) {
            .student-card .card-content {
            display: flex;
                flex-wrap: nowrap;
                gap: 1rem;
                overflow-x: auto;
                scrollbar-width: thin;
                scrollbar-color: #e9ecef transparent;
                padding-bottom: 0.5rem;
            }
            
            .student-card .card-content::-webkit-scrollbar {
                height: 4px;
            }
            
            .student-card .card-content::-webkit-scrollbar-track {
            background: transparent;
        }
            
            .student-card .card-content::-webkit-scrollbar-thumb {
                background: #e9ecef;
                border-radius: 2px;
            }
            
            .student-card .card-content::-webkit-scrollbar-thumb:hover {
                background: #d1d5db;
            }
            
            .student-card .basic-info,
            .student-card .education-info,
            .student-card .skills-info {
                min-width: 200px;
                max-width: 250px;
                flex-shrink: 0;
                border-right: 1px solid #e9ecef;
                padding-right: 1rem;
            }
            
            .student-card .actions {
                min-width: 120px;
                flex-shrink: 0;
                border-right: none;
                padding-left: 0.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .search-container { padding: 1rem; margin: 1.5rem 0; border-radius: 8px; }
            .search-box { flex-direction: row; gap: 0.5rem; padding: 0.8rem; }
            .search-icon { font-size: 1.2rem; margin-left: 0.5rem; }
            .search-input { padding: 0.8rem 0.4rem; font-size: 0.95rem; }
            .search-btn { padding: 0.8rem 1.5rem; border-radius: 6px; }
            .btn-text { font-size: 0.95rem; }
            .btn-icon { font-size: 0.9rem; }
            .search-info { padding: 1.5rem; font-size: 0.9rem; }
            .search-info h3 { font-size: 1.2rem; }
            .search-info .ai-icon { font-size: 1.5rem; }
            
            .student-card {
                flex-direction: row;
                align-items: center;
                padding: 1rem;
                max-width: 100%;
                margin: 0 1rem 1rem 1rem;
                width: calc(100% - 2rem);
            }
            
            .student-card img.profile-pic {
                width: 50px;
                height: 50px;
                flex-shrink: 0;
            }
            
            .student-card .card-content {
                display: flex;
                flex-wrap: nowrap;
                gap: 1rem;
                overflow-x: auto;
                scrollbar-width: thin;
                scrollbar-color: #e9ecef transparent;
                padding-bottom: 0.5rem;
                width: 100%;
            }
            
            .student-card .card-content::-webkit-scrollbar {
                height: 3px;
            }
            
            .student-card .card-content::-webkit-scrollbar-track {
                background: transparent;
            }
            
            .student-card .card-content::-webkit-scrollbar-thumb {
                background: #e9ecef;
                border-radius: 2px;
            }
            
            .student-card .basic-info,
            .student-card .education-info,
            .student-card .skills-info {
                min-width: 180px;
                max-width: 220px;
                flex-shrink: 0;
                border-right: 1px solid #e9ecef;
                padding-right: 0.8rem;
            }
            
            .student-card .actions {
                min-width: 100px;
                flex-shrink: 0;
                border-right: none;
                padding-left: 0.5rem;
            }
            
            .student-card h3 { font-size: 1rem; }
            .student-card h4 { font-size: 0.85rem; }
            .student-card .year-badge { font-size: 0.7rem; }
            .student-card p { font-size: 0.85rem; }
        }
        
        @media (max-width: 480px) {
            .student-card {
                margin: 0 0.5rem 1rem 0.5rem;
                width: calc(100% - 1rem);
                padding: 0.8rem;
            }
            
            .student-card img.profile-pic {
                width: 45px;
                height: 45px;
            }
            
            .student-card .card-content {
                gap: 0.8rem;
                padding-bottom: 0.3rem;
            }
            
            .student-card .basic-info,
            .student-card .education-info,
            .student-card .skills-info {
                min-width: 160px;
                max-width: 200px;
                padding-right: 0.6rem;
            }
            
            .student-card .actions {
                min-width: 90px;
                padding-left: 0.3rem;
            }
            
            .student-card h3 { font-size: 0.95rem; }
            .student-card h4 { font-size: 0.8rem; }
            .student-card .year-badge { font-size: 0.65rem; }
            .student-card p { font-size: 0.8rem; }
        }
        
        @media (min-width: 768px) {
            .students-list { align-items: center; }
        }
        
        .card-tooltip {
            position: fixed;
            z-index: 3000;
            background: rgba(255,255,255,0.97);
            backdrop-filter: blur(8px) saturate(1.1);
            -webkit-backdrop-filter: blur(8px) saturate(1.1);
            color: #222;
            font-size: 0.97rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 16px 0 rgba(30,34,90,0.13);
            border: 1px solid #e0e0e0;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.13s;
            max-width: 420px;
            min-width: 80px;
            word-break: break-word;
            white-space: pre-line;
        }
        
        .card-tooltip.active {
            opacity: 1;
        }
        
        /* Login Popup Styles */
        .login-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        
        .login-popup.active {
                display: flex;
            opacity: 1;
        }
        
        .login-popup-content {
            background: #fff;
            border-radius: 0.7rem;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.2);
            max-width: 420px;
            width: 90%;
            margin: 20px;
            transform: scale(0.9) translateY(20px);
            transition: all 0.4s ease;
            overflow: hidden;
            border: 1px solid #e9ecef;
        }
        
        .login-popup.active .login-popup-content {
            transform: scale(1) translateY(0);
        }
        
        .login-popup-header {
            background: #fff;
            color: #111;
            padding: 1.8rem 2rem;
            text-align: center;
            position: relative;
            border-bottom: 1px solid #e9ecef;
        }
        
        .login-popup-header h3 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: 600;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
            letter-spacing: -0.01em;
            color: #111;
        }
        
        .login-popup-body {
            padding: 2.5rem 2rem;
            text-align: center;
            background: #fff;
        }
        
        .popup-icon {
            font-size: 3.5rem;
            color: #facc15;
            margin-bottom: 1.5rem;
            display: block;
        }
        
        .login-popup-body h4 {
            color: #111;
            font-size: 1.3rem;
            font-weight: 600;
            margin: 0 0 0.8rem 0;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .login-popup-body p {
            color: #666;
            font-size: 1rem;
            line-height: 1.6;
            margin: 0 0 2rem 0;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
        }
        
        .login-btn {
            background: #fff;
            color: #111;
            border: 1.5px solid #111;
            padding: 0.9rem 1.8rem;
            border-radius: 0.7rem;
            font-size: 1.05rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.18s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            font-family: 'Montserrat', 'Manrope', 'Poppins', 'Inter', Arial, sans-serif;
            text-decoration: none;
            min-width: 160px;
            justify-content: center;
        }
        
        .login-btn:hover {
            background: #facc15;
            color: #111;
            border-color: #facc15;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(250, 204, 21, 0.3);
        }
        
        @media (max-width: 480px) {
            .login-popup-content {
                margin: 15px;
                width: 95%;
            }
            
            .login-popup-header {
                padding: 1.5rem 1.5rem;
            }
            
            .login-popup-header h3 {
                font-size: 1.2rem;
            }
            
            .login-popup-body {
                padding: 2rem 1.5rem;
            }
            
            .popup-icon {
                font-size: 3rem;
            }
            
            .login-popup-body h4 {
                font-size: 1.2rem;
            }
            
            .login-popup-body p {
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
   
    
    
    <main class="dashboard-content">
        <section class="dashboard-section">
            
            
            <div class="search-box" style="display:none;">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="ai-search-input" 
                       placeholder="e.g., IIT Delhi B.Tech Applied Mechanics student with Python skill">
                <button class="search-btn" onclick="performSearch()">
                    <span class="btn-text">Search Talent</span>
                    <i class="fas fa-arrow-right btn-icon"></i>
                </button>
            </div>
            <br>
            <br>
            <div class="search-info" id="searchInfo">
                
                    </div>
            <div class="loading-overlay" id="loadingOverlay">
                <div class="fashion-loader">
                    <div class="fashion-loader-icon"></div>
                    <div class="fashion-loader-text">Analysing your prompt...</div>
                    <div class="fashion-loader-subtitle">Searching database • Sorting students • Finding matches</div>
                    <div class="fashion-loader-dots">
                        <div class="fashion-loader-dot"></div>
                        <div class="fashion-loader-dot"></div>
                        <div class="fashion-loader-dot"></div>
                    </div>
                    <div class="fashion-loader-progress">
                        <div class="fashion-loader-progress-bar"></div>
                    </div>
                    </div>
            </div>
            <div class="students-list" id="students-list"></div>
            <div class="pagination" id="pagination"></div>
        </section>
    </main>
  
    <div class="overlay" id="overlay"></div>
    
    <!-- Login Popup Modal -->
    <div class="login-popup" id="login-popup">
        <div class="login-popup-content">
            <div class="login-popup-header">
                <h3>Perfect Matches Found!</h3>
    </div>
            <div class="login-popup-body">
                <div class="popup-icon">
                    <i class="fas fa-user-check"></i>
        </div>
                <h4>We found the best students for your needs</h4>
                <p>Login to connect with them and start working on your project.</p>
                <button class="login-btn" onclick="goToLogin()">
                    <i class="fas fa-sign-in-alt"></i>
                    Login to Continue
                </button>
    </div>
    </div>
    </div>
    
    <!-- Removed unused popup elements since we redirect to login.html -->
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script>
        // Initialize Firebase
const firebaseConfig = {
    apiKey: "AIzaSyDZIDlEtaNRxODoFhRw0xF2yYFBqqBexqo",
    authDomain: "taska-45011.firebaseapp.com",
    databaseURL: "https://taska-45011-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "taska-45011",
    storageBucket: "taska-45011.appspot.com",
    messagingSenderId: "205487498813",
    appId: "1:205487498813:web:0de2c9eab567482781ec54",
    measurementId: "G-G0G1F6GQ9B"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// Hamburger menu toggle
document.addEventListener('DOMContentLoaded', () => {
    // Search on Enter key
    document.getElementById('ai-search-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            performSearch();
        }
    });
});


let studentsData = [];
let currentStudentId = null;
let connectedStudents = new Set();
const studentsList = document.getElementById('students-list');
const profilePopup = document.getElementById('profilePopup');
const profileContent = document.getElementById('profileContent');
const overlay = document.getElementById('overlay');
const loadingOverlay = document.getElementById('loadingOverlay');
const messagePopup = document.getElementById('messagePopup');
const introMessage = document.getElementById('introMessage');
const searchInfo = document.getElementById('searchInfo');

// Fetch student data and connected students
document.addEventListener('DOMContentLoaded', async () => {
    try {
        // Fetch student data from Firebase
        const snapshot = await database.ref('studentslist').once('value');
        const data = snapshot.val() || {};
        studentsData = Object.keys(data).map(id => ({
            id,
            ...data[id],
            personal: data[id].personal || {},
            education: data[id].education || {},
            skills: data[id].skills || '',
            profiles: data[id].profiles || {},
            portfolio: data[id].portfolio || []
        }));

        // Fetch connected students
        const connections = await getConnectedStudents();
        connectedStudents = new Set(connections);
        
        // Check if there's a search query in the URL and perform search
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('q');
        if (searchQuery) {
            // Set the search input value
            document.getElementById('ai-search-input').value = searchQuery;
            // Perform the search
            aiSearch(searchQuery);
        }
        
    } catch (error) {
        console.error('Error loading data:', error);
        studentsList.innerHTML = '<p>Error loading student data.</p>';
    }
});

// Login popup functions
function showLoginPopup() {
    const popup = document.getElementById('login-popup');
    if (popup) {
        popup.classList.add('active');
    }
}

function closeLoginPopup() {
    const popup = document.getElementById('login-popup');
    if (popup) {
        popup.classList.remove('active');
    }
}

function goToLogin() {
    window.location.href = '../login.html';
}

// Close popup when clicking outside
// document.addEventListener('click', (event) => {
//     const popup = document.getElementById('login-popup');
//     if (popup && event.target === popup) {
//         closeLoginPopup();
//     }
// });

// Fetch connected students from Firebase
async function getConnectedStudents() {
    const user = firebase.auth().currentUser;
    if (!user) return [];
    try {
        const snapshot = await database.ref(`users/${user.uid}/connections`).once('value');
        const connections = snapshot.val() || {};
        return Object.keys(connections).filter(id => ['pending', 'connected'].includes(connections[id].status));
    } catch (error) {
        console.error('Error fetching connections:', error);
        return [];
    }
}

// Map education year to label
function getYearLabel(year) {
    if (!year || year === 'Not set') return 'Student';
    const yearMap = {
        '1st': 'Freshman',
        '2nd': 'Sophomore',
        '3rd': 'Junior',
        '4th': 'Senior',
        '5th': 'Alumni'
    };
    return yearMap[year] || 'Alumni';
}

async function aiSearch(query = '') {
    if (!query) {
        studentsList.innerHTML = '<p>Please enter a search query</p>';
        searchInfo.style.display = 'block'; // Show help cards when no search
        return;
    }
    loadingOverlay.style.display = 'flex';
    searchInfo.style.display = 'none'; // Hide help cards when searching

    // Update loading text for different stages
    const loadingText = document.querySelector('.fashion-loader-text');
    const loadingSubtitle = document.querySelector('.fashion-loader-subtitle');
    
    const updateLoadingText = (text, subtitle) => {
        if (loadingText) loadingText.textContent = text;
        if (loadingSubtitle) loadingSubtitle.textContent = subtitle;
    };

    // Pre-filter to get 15 most relevant students before sending to AI
    updateLoadingText('Analysing your prompt...', 'Searching database • Sorting students • Finding matches');
    
    // Add delay before next stage
    await new Promise(resolve => setTimeout(resolve, 800));
    
    const preFilteredStudents = preFilterStudents(query, 15);
    
    updateLoadingText('Searching database...', 'Filtering students • Matching skills • Preparing data');
    
    // Add delay before next stage
    await new Promise(resolve => setTimeout(resolve, 600));

    const csvText = [
        ['id', 'personal.name', 'education.college', 'education.degree', 'education.branch', 'education.year', 'skills', 'personal.about'].join(','),
        ...preFilteredStudents.map(student => [
            student.id,
            student.personal?.name || 'Unnamed',
            student.education?.college || 'Not set',
            student.education?.degree || 'Not set',
            student.education?.branch || 'Not set',
            student.education?.year || 'Not set',
            student.skills || 'Not set',
            student.personal?.about || 'Not set'
        ].join(','))
    ].join('\n');

    updateLoadingText('Processing with AI...', 'Analyzing matches • Ranking students • Finalizing results');
    
    // Add delay before final stage
    await new Promise(resolve => setTimeout(resolve, 500));

    const prompt = `
        You are an expert at analyzing student data for talent matching. Given the following CSV data of 15 pre-filtered students:
        ${csvText}
        The user has provided this requirement: "${query}"
        Your task is to:
        1. Carefully analyze each student's data (name, college, degree, branch, year, skills, about).
        2. Match students to the requirement based on relevance (e.g., specific college, skills, branch, or about section mentioned in the query).
        3. Rank the students by how well they match the requirement.
        4. Return EXACTLY 10 student IDs in order of relevance as a JSON array of strings.
        5. If fewer than 10 students match exactly, fill the remaining slots with the most relevant students based on partial matches.
        6. Do not simply return the first 10 students unless they genuinely match the query.
        Examples:
        - Query: "IIT Delhi B.Tech Applied Mechanics student with Python skill"
          - Prioritize students from IIT Delhi, with B.Tech in Applied Mechanics, and Python in skills.
        - Query: "IIT Bombay student with machine learning experience"
          - Prioritize IIT Bombay students with "machine learning" in skills or about section.
        Return the result STRICTLY as a JSON array of 10 student IDs, e.g.:
        ["student_1", "student_2", "student_3", "student_4", "student_5", "student_6", "student_7", "student_8", "student_9", "student_10"]
    `;

    try {
        updateLoadingText('Finalizing results...', 'Almost done...');
        
        const response = await fetch('/api/ai-search', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ prompt }),
        });
        const data = await response.json();
        if (!response.ok) throw new Error(data.error?.message || 'API request failed');

        let shortlistedIds;
        try {
            shortlistedIds = JSON.parse(data.choices[0].message.content);
            if (!Array.isArray(shortlistedIds) || shortlistedIds.length !== 10 || !shortlistedIds.every(id => typeof id === 'string')) {
                throw new Error('Invalid response format: Expected an array of 10 student IDs');
            }
            const validIds = shortlistedIds.filter(id => preFilteredStudents.some(student => student.id === id));
            if (validIds.length < 10) {
                console.warn('AI returned fewer valid IDs than expected:', validIds);
                const remainingCount = 10 - validIds.length;
                const additionalIds = preFilteredStudents
                    .filter(student => !validIds.includes(student.id) && !connectedStudents.has(student.id))
                    .slice(0, remainingCount)
                    .map(student => student.id);
                shortlistedIds = [...validIds, ...additionalIds];
            }
        } catch (parseError) {
            console.error('JSON Parse Error:', parseError, 'Response:', data.choices[0].message.content);
            shortlistedIds = basicKeywordMatch(query, preFilteredStudents);
        }

        const filteredStudents = preFilteredStudents
            .filter(student => shortlistedIds.includes(student.id) && !connectedStudents.has(student.id))
            .sort((a, b) => shortlistedIds.indexOf(a.id) - shortlistedIds.indexOf(b.id));

        studentsList.innerHTML = filteredStudents.length > 0
            ? filteredStudents.map(student => {
                const personal = student.personal || {};
                const education = student.education || {};
                const profiles = student.profiles || {};
                const availability = student.availability || {};
                const softSkills = student.softSkills || {};
                const preferences = student.preferences || {};
                const yearLabel = getYearLabel(education?.year);
                const isConnected = connectedStudents.has(student.id);
                const hasLinkedIn = !!personal.linkedin;
                
                return `
                    <div class="student-card">
                        <img src="https://firebasestorage.googleapis.com/v0/b/taska-45011.appspot.com/o/profile%2F${student.id}.webp?alt=media" alt="Profile Picture" class="profile-pic" onerror="this.src='../assets/avatar/1.png'">
                        <div class="card-content">
                            <div class="basic-info">
                                <h3>${personal.name || 'Unnamed'}</h3>
                                <h4>${education.college || 'Not set'}<span class="year-badge">${yearLabel}</span></h4>
                            </div>
                            <div class="education-info">
                                <p><strong>${education.degree || 'Not set'}</strong></p>
                                <p>${education.branch || 'Not set'}</p>
                            </div>
                            <div class="skills-info">
                                <p><strong>Skills:</strong> ${student.skills || 'Not specified'}</p>
                                ${personal.about ? `<p>${personal.about.substring(0, 80)}${personal.about.length > 80 ? '...' : ''}</p>` : ''}
                            </div>
                            
                        </div>
                    </div>
                `;
            }).join('')
            : '<p>No matching students found.</p>';
            
        // Show login popup 5 seconds after results are displayed
        setTimeout(() => {
            showLoginPopup();
        }, 3000);
    } catch (error) {
        console.error('AI Search Error:', error);
        studentsList.innerHTML = `<p>Error performing search: ${error.message}</p>`;
    }
    loadingOverlay.style.display = 'none';
}

// Pre-filter students to get the most relevant ones before sending to AI
function preFilterStudents(query, limit = 15) {
    const keywords = query.toLowerCase().split(' ').filter(word => word.length > 2);
    const scoredStudents = studentsData
        .filter(student => !connectedStudents.has(student.id))
        .map(student => {
            let score = 0;
            const studentText = `${student.personal?.name || ''} ${student.education?.college || ''} ${student.education?.degree || ''} ${student.education?.branch || ''} ${student.skills || ''} ${student.personal?.about || ''}`.toLowerCase();
            
            // Exact matches get higher scores
            keywords.forEach(keyword => {
                if (studentText.includes(keyword)) {
                    score += 2; // Higher weight for keyword matches
                }
                // Partial matches
                if (studentText.includes(keyword.substring(0, Math.floor(keyword.length * 0.7)))) {
                    score += 1;
                }
            });
            
            // Bonus for college matches
            if (query.toLowerCase().includes('iit') && student.education?.college?.toLowerCase().includes('iit')) {
                score += 3;
            }
            if (query.toLowerCase().includes('nit') && student.education?.college?.toLowerCase().includes('nit')) {
                score += 3;
            }
            if (query.toLowerCase().includes('iiit') && student.education?.college?.toLowerCase().includes('iiit')) {
                score += 3;
            }
            
            // Bonus for skill matches
            if (query.toLowerCase().includes('python') && student.skills?.toLowerCase().includes('python')) {
                score += 2;
            }
            if (query.toLowerCase().includes('react') && student.skills?.toLowerCase().includes('react')) {
                score += 2;
            }
            if (query.toLowerCase().includes('machine learning') && student.skills?.toLowerCase().includes('machine learning')) {
                score += 2;
            }
            
            return { student, score };
        });
    
    return scoredStudents
        .sort((a, b) => b.score - a.score)
        .slice(0, limit)
        .map(item => item.student);
}

function basicKeywordMatch(query, preFilteredStudents = null) {
    const studentsToSearch = preFilteredStudents || studentsData;
    const keywords = query.toLowerCase().split(' ');
    const scoredStudents = studentsToSearch
        .filter(student => !connectedStudents.has(student.id))
        .map(student => {
            let score = 0;
            const studentText = `${student.personal?.name || ''} ${student.education?.college || ''} ${student.education?.degree || ''} ${student.education?.branch || ''} ${student.skills || ''} ${student.personal?.about || ''}`.toLowerCase();
            keywords.forEach(keyword => {
                if (studentText.includes(keyword)) score += 1;
            });
            return { id: student.id, score };
        });
    return scoredStudents
        .sort((a, b) => b.score - a.score)
        .slice(0, 10)
        .map(student => student.id);
}

window.performSearch = () => {
    const query = document.getElementById('ai-search-input').value.trim();
    if (!query) {
        studentsList.innerHTML = '<p style="text-align: center; color: #666; font-size: 1.1rem; margin: 2rem 0;">Please enter a search query to find students</p>';
        searchInfo.style.display = 'block'; // Show help cards when no search
        return;
    }
    aiSearch(query);
};

window.toggleReadMore = (element) => {
    const description = element.previousElementSibling;
    description.classList.toggle('expanded');
    element.textContent = description.classList.contains('expanded') ? 'Read Less' : 'Read More';
};

window.toggleStudentDetails = (element) => {
    const card = element.closest('.student-card');
    const details = card.querySelector('.student-details');
    details.classList.toggle('expanded');
    element.textContent = details.classList.contains('expanded') ? 'Hide Details' : 'View Details';
};

window.generateAIIntro = async (studentId) => {
    // Redirect to login page instead of performing connection
    window.location.href = '../login.html';
};

window.showStudentDetailsPopup = (studentId) => {
    // Redirect to login page instead of showing popup
    window.location.href = '../login.html';
};

window.closeConnectionRequestPopup = () => {
    // This function is no longer needed since we redirect to login
    console.log('Connection popup functionality removed');
};

window.showProfile = (targetUserId) => {
    // Redirect to login page
    window.location.href = '../login.html';
};

window.closeProfilePopup = () => {
    // This function is no longer needed
    console.log('Profile popup functionality removed');
};

window.closeMessagePopup = () => {
    // This function is no longer needed
    console.log('Message popup functionality removed');
};

window.sendMessage = () => {
    // Redirect to login page
    window.location.href = '../login.html';
};

async function storeConnection(studentId) {
    // This function is no longer needed since we redirect to login
    console.log('Store connection functionality removed');
}

overlay.addEventListener('click', () => {
    // Overlay click functionality removed since we redirect to login
    console.log('Overlay click functionality removed');
});

// Remove unused functions
window.closeStudentDetailsPopup = () => {
    // This function is no longer needed
    console.log('Student details popup functionality removed');
};

// Tooltip for truncated card content
let cardTooltip;
function showCardTooltip(e, text) {
    if (!cardTooltip) {
        cardTooltip = document.createElement('div');
        cardTooltip.className = 'card-tooltip';
        document.body.appendChild(cardTooltip);
    }
    cardTooltip.textContent = text;
    cardTooltip.classList.add('active');
    // Position tooltip near mouse, but not off screen
    const padding = 12;
    let x = e.clientX + padding;
    let y = e.clientY + padding;
    // Adjust if tooltip would go off right/bottom edge
    setTimeout(() => {
        const rect = cardTooltip.getBoundingClientRect();
        if (x + rect.width > window.innerWidth - 8) x = window.innerWidth - rect.width - 8;
        if (y + rect.height > window.innerHeight - 8) y = window.innerHeight - rect.height - 8;
        cardTooltip.style.left = x + 'px';
        cardTooltip.style.top = y + 'px';
    }, 0);
}
function hideCardTooltip() {
    if (cardTooltip) cardTooltip.classList.remove('active');
}
function isTruncated(el) {
    return el.scrollWidth > el.clientWidth;
}
function addTooltipListenersToCardCells() {
    // Select all card content cells that may overflow
    const selectors = [
        '.student-card .basic-info h3',
        '.student-card .basic-info h4',
        '.student-card .education-info p',
        '.student-card .skills-info p'
    ];
    document.querySelectorAll(selectors.join(',')).forEach(cell => {
        cell.onmouseenter = function(e) {
            if (isTruncated(this)) {
                showCardTooltip(e, this.textContent);
                console.log('Tooltip shown for:', this.textContent);
            } else {
                console.log('Not truncated:', this.textContent);
            }
        };
        cell.onmousemove = function(e) {
            if (cardTooltip && cardTooltip.classList.contains('active')) {
                showCardTooltip(e, this.textContent);
            }
        };
        cell.onmouseleave = function() {
            hideCardTooltip();
        };
    });
    console.log('Tooltip listeners attached to card cells');
}
// Re-apply listeners after cards are rendered
const origPerformSearch = window.performSearch;
window.performSearch = function() {
    origPerformSearch.apply(this, arguments);
    setTimeout(addTooltipListenersToCardCells, 0);
};
window.addEventListener('DOMContentLoaded', addTooltipListenersToCardCells);
</script>
</body>
</html>